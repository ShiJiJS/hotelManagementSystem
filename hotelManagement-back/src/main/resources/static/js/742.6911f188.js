"use strict";(self["webpackChunkvue_hotel_management_project"]=self["webpackChunkvue_hotel_management_project"]||[]).push([[742],{9742:function(t,o,e){e.r(o),e.d(o,{default:function(){return c}});var i=function(){var t=this,o=t._self._c;return o("div",[o("el-breadcrumb",{staticStyle:{"font-size":"24px","margin-bottom":"12px"},attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",[t._v("消费管理")]),o("el-breadcrumb-item",[t._v("附加消费管理")])],1),o("el-row",{staticStyle:{"margin-bottom":"12px"},attrs:{gutter:20}},[o("el-col",{attrs:{span:20}},[o("el-input",{staticStyle:{"line-height":"36px"},attrs:{placeholder:"请输入客房编号"},model:{value:t.input,callback:function(o){t.input=o},expression:"input"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),o("el-col",{attrs:{span:4}},[o("el-button",{attrs:{type:"primary"},on:{click:function(o){t.addConsumptionDialogVisible=!0}}},[t._v(" 新增消费 ")]),o("el-button",{attrs:{type:"danger"},on:{click:function(o){t.massDeletionDialogVisible=!0}}},[t._v(" 批量删除 ")])],1)],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),o("el-table-column",{attrs:{prop:"checkInId",label:"入住单号"}}),o("el-table-column",{attrs:{prop:"roomId",label:"客房编号"}}),o("el-table-column",{attrs:{prop:"totalPrice",label:"合计",width:"180"}}),o("el-table-column",{attrs:{prop:"operator",label:"操作员",width:"180"}}),o("el-table-column",{attrs:{prop:"time",label:"消费时间"}}),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"270"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.showConsumptionEditDialog(e.row.id)}}},[t._v("编辑")]),o("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.showPrintDialog(e.row.id)}}},[t._v("打印")]),o("el-button",{attrs:{type:"danger"},on:{click:function(o){return t.showConsumptionDeleteDialog(e.row.id)}}},[t._v("删除")])]}}])})],1),o("el-dialog",{attrs:{title:"删除",visible:t.consumptionDeletionDialogVisible,width:"30%",center:""},on:{"update:visible":function(o){t.consumptionDeletionDialogVisible=o}}},[o("span",[t._v("确定要删除该项目吗？")]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(o){t.consumptionDeletionDialogVisible=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"danger"},on:{click:t.deleteByIdConsumption}},[t._v("确 定")])],1)]),o("el-dialog",{attrs:{title:"批量删除",visible:t.massDeletionDialogVisible,width:"30%",center:""},on:{"update:visible":function(o){t.massDeletionDialogVisible=o}}},[o("span",[t._v("确定要批量删除选中的项目吗？")]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(o){t.massDeletionDialogVisible=!1}}},[t._v("取 消")]),o("el-button",{attrs:{type:"danger"},on:{click:t.deleteByIdsConsumption}},[t._v("确 定")])],1)]),o("el-dialog",{attrs:{title:"新增消费信息",visible:t.addConsumptionDialogVisible,fullscreen:"",center:"","before-close":t.closeButton},on:{"update:visible":function(o){t.addConsumptionDialogVisible=o}}},[o("el-row",{staticStyle:{"margin-bottom":"12px"},attrs:{gutter:20}},[o("el-button",{staticStyle:{position:"relative",left:"85%"},attrs:{type:"primary"},on:{click:function(o){t.addConsumptionDetailDialogVisible=!0}}},[t._v("新增商品")])],1),o("el-form",{ref:"addConsumptionFormRef",attrs:{model:t.addConsumptionForm,rules:t.ConsumptionRules,"label-width":"80px"}},[o("el-table",{staticStyle:{"margin-left":"60px","margin-right":"60px","margin-bottom":"24px",width:"auto"},attrs:{data:t.dialogTableData,border:""}},[o("el-table-column",{attrs:{prop:"goodsName",label:"商品名"}}),o("el-table-column",{attrs:{prop:"count",label:"数量",disabled:""}}),o("el-table-column",{attrs:{prop:"unitPrice",label:"单价",disabled:""}}),o("el-table-column",{attrs:{prop:"consumePrice",label:"消费金额",disabled:""}}),o("el-table-column",{attrs:{prop:"discountRate",label:"折扣率"}}),o("el-table-column",{attrs:{prop:"discountPrice",label:"折后金额",disabled:""}}),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"danger"},on:{click:function(o){return t.addEditDeletion(e.row)}}},[t._v("删除")])]}}])})],1),o("el-form-item",{attrs:{label:"入住单号",prop:"checkInId"}},[o("el-input",{model:{value:t.addConsumptionForm.checkInId,callback:function(o){t.$set(t.addConsumptionForm,"checkInId",o)},expression:"addConsumptionForm.checkInId"}})],1),o("el-form-item",{attrs:{label:"客房编号",prop:"roomNumber"}},[o("el-input",{model:{value:t.addConsumptionForm.roomId,callback:function(o){t.$set(t.addConsumptionForm,"roomId",o)},expression:"addConsumptionForm.roomId"}})],1),o("el-form-item",{attrs:{label:"合计",prop:"totalPrice"}},[o("el-input",{attrs:{disabled:""},model:{value:t.addConsumptionForm.totalPrice,callback:function(o){t.$set(t.addConsumptionForm,"totalPrice",o)},expression:"addConsumptionForm.totalPrice"}})],1),o("el-form-item",{attrs:{label:"操作员",prop:"operator"}},[o("el-input",{model:{value:t.addConsumptionForm.operator,callback:function(o){t.$set(t.addConsumptionForm,"operator",o)},expression:"addConsumptionForm.operator"}})],1),o("el-form-item",{attrs:{label:"时间",prop:"time"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.addConsumptionForm.time,callback:function(o){t.$set(t.addConsumptionForm,"time",o)},expression:"addConsumptionForm.time"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeButton}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.addConsumption}},[t._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"新增具体消费信息",visible:t.addConsumptionDetailDialogVisible,width:"30%",center:"","before-close":t.closeButton},on:{"update:visible":function(o){t.addConsumptionDetailDialogVisible=o}}},[o("el-form",{ref:"editConsumptionDetailFormRef",attrs:{model:t.addConsumptionDetailForm,rules:t.ConsumptionRules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"商品名",prop:"goodsName"}},[o("el-select",{attrs:{placeholder:"请选择类型"},on:{change:function(o){return t.holdAllChange(t.addConsumptionDetailForm)}},model:{value:t.addConsumptionDetailForm.goodsName,callback:function(o){t.$set(t.addConsumptionDetailForm,"goodsName",o)},expression:"addConsumptionDetailForm.goodsName"}},t._l(t.goods,(function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1)],1),o("el-form-item",{attrs:{label:"数量",prop:"count"}},[o("el-input",{on:{change:function(o){return t.holdAllChange(t.addConsumptionDetailForm)}},model:{value:t.addConsumptionDetailForm.count,callback:function(o){t.$set(t.addConsumptionDetailForm,"count",o)},expression:"addConsumptionDetailForm.count"}})],1),o("el-form-item",{attrs:{label:"单价",prop:"unitPrice",disabled:""}},[o("el-input",{attrs:{disabled:""},model:{value:t.addConsumptionDetailForm.unitPrice,callback:function(o){t.$set(t.addConsumptionDetailForm,"unitPrice",o)},expression:"addConsumptionDetailForm.unitPrice"}})],1),o("el-form-item",{attrs:{label:"消费金额",prop:"consumePrice",disabled:""}},[o("el-input",{attrs:{disabled:""},model:{value:t.addConsumptionDetailForm.consumePrice,callback:function(o){t.$set(t.addConsumptionDetailForm,"consumePrice",o)},expression:"addConsumptionDetailForm.consumePrice"}})],1),o("el-form-item",{attrs:{label:"折扣率",prop:"discountRate"}},[o("el-input",{on:{change:function(o){return t.holdAllChange(t.addConsumptionDetailForm)}},model:{value:t.addConsumptionDetailForm.discountRate,callback:function(o){t.$set(t.addConsumptionDetailForm,"discountRate",o)},expression:"addConsumptionDetailForm.discountRate"}})],1),o("el-form-item",{attrs:{label:"折后金额",prop:"discountPrice",disabled:""}},[o("el-input",{attrs:{disabled:""},model:{value:t.addConsumptionDetailForm.discountPrice,callback:function(o){t.$set(t.addConsumptionDetailForm,"discountPrice",o)},expression:"addConsumptionDetailForm.discountPrice"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeButton}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.addNewGoodsDetail}},[t._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"修改消费信息",visible:t.editConsumptionDialogVisible,fullscreen:"",center:"","before-close":t.closeButton},on:{"update:visible":function(o){t.editConsumptionDialogVisible=o}}},[o("el-row",{staticStyle:{"margin-bottom":"12px"},attrs:{gutter:20}},[o("el-button",{staticStyle:{position:"relative",left:"85%"},attrs:{type:"primary"},on:{click:function(o){t.addConsumptionDetailDialogVisible=!0}}},[t._v("新增商品")])],1),o("el-form",{ref:"editConsumptionFormRef",attrs:{model:t.editConsumptionForm,rules:t.ConsumptionRules,"label-width":"80px"}},[o("el-table",{staticStyle:{"margin-left":"60px","margin-right":"60px","margin-bottom":"24px",width:"auto"},attrs:{data:t.dialogTableData,border:""}},[o("el-table-column",{attrs:{prop:"goodsName",label:"商品名"}}),o("el-table-column",{attrs:{prop:"count",label:"数量"}}),o("el-table-column",{attrs:{prop:"unitPrice",label:"单价"}}),o("el-table-column",{attrs:{prop:"consumePrice",label:"消费金额"}}),o("el-table-column",{attrs:{prop:"discountRate",label:"折扣率"}}),o("el-table-column",{attrs:{prop:"discountPrice",label:"折后金额"}}),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"danger"},on:{click:function(o){return t.editDeletion(e.row)}}},[t._v("删除")])]}}])})],1),o("el-form-item",{attrs:{label:"入住单号",prop:"checkInId"}},[o("el-input",{model:{value:t.editConsumptionForm.checkInId,callback:function(o){t.$set(t.editConsumptionForm,"checkInId",o)},expression:"editConsumptionForm.checkInId"}})],1),o("el-form-item",{attrs:{label:"客房编号",prop:"roomId"}},[o("el-input",{model:{value:t.editConsumptionForm.roomId,callback:function(o){t.$set(t.editConsumptionForm,"roomId",o)},expression:"editConsumptionForm.roomId"}})],1),o("el-form-item",{attrs:{label:"合计",prop:"totalPrice"}},[o("el-input",{attrs:{disabled:""},model:{value:t.editConsumptionForm.totalPrice,callback:function(o){t.$set(t.editConsumptionForm,"totalPrice",o)},expression:"editConsumptionForm.totalPrice"}})],1),o("el-form-item",{attrs:{label:"操作员",prop:"operator"}},[o("el-input",{model:{value:t.editConsumptionForm.operator,callback:function(o){t.$set(t.editConsumptionForm,"operator",o)},expression:"editConsumptionForm.operator"}})],1),o("el-form-item",{attrs:{label:"时间",prop:"time"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.editConsumptionForm.time,callback:function(o){t.$set(t.editConsumptionForm,"time",o)},expression:"editConsumptionForm.time"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeButton}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.editConsumption}},[t._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"修改具体消费信息",visible:t.editConsumptionDetailDialogVisible,width:"30%",center:"","before-close":t.closeButton},on:{"update:visible":function(o){t.editConsumptionDetailDialogVisible=o}}},[o("el-form",{ref:"editAddConsumptionFormRef",attrs:{model:t.editConsumptionDetailForm,rules:t.ConsumptionRules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"商品名",prop:"goodsName"}},[o("el-select",{attrs:{placeholder:"请选择类型"},on:{change:function(o){return t.holdAllChange(t.editConsumptionDetailForm)}},model:{value:t.editConsumptionDetailForm.goodsName,callback:function(o){t.$set(t.editConsumptionDetailForm,"goodsName",o)},expression:"editConsumptionDetailForm.goodsName"}},t._l(t.goods,(function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1)],1),o("el-form-item",{attrs:{label:"数量",prop:"count"},on:{change:function(o){return t.holdAllChange(t.editConsumptionDetailForm)}}},[o("el-input",{model:{value:t.editConsumptionDetailForm.count,callback:function(o){t.$set(t.editConsumptionDetailForm,"count",o)},expression:"editConsumptionDetailForm.count"}})],1),o("el-form-item",{attrs:{label:"单价",prop:"unitPrice"}},[o("el-input",{attrs:{disabled:""},model:{value:t.editConsumptionDetailForm.unitPrice,callback:function(o){t.$set(t.editConsumptionDetailForm,"unitPrice",o)},expression:"editConsumptionDetailForm.unitPrice"}})],1),o("el-form-item",{attrs:{label:"消费金额",prop:"consumePrice"}},[o("el-input",{attrs:{disabled:""},model:{value:t.editConsumptionDetailForm.consumePrice,callback:function(o){t.$set(t.editConsumptionDetailForm,"consumePrice",o)},expression:"editConsumptionDetailForm.consumePrice"}})],1),o("el-form-item",{attrs:{label:"折扣率",prop:"discountRate"},on:{change:function(o){return t.holdAllChange(t.editConsumptionDetailForm)}}},[o("el-input",{model:{value:t.editConsumptionDetailForm.discountRate,callback:function(o){t.$set(t.editConsumptionDetailForm,"discountRate",o)},expression:"editConsumptionDetailForm.discountRate"}})],1),o("el-form-item",{attrs:{label:"折后金额",prop:"discountPrice"}},[o("el-input",{attrs:{disabled:""},model:{value:t.editConsumptionDetailForm.discountPrice,callback:function(o){t.$set(t.editConsumptionDetailForm,"discountPrice",o)},expression:"editConsumptionDetailForm.discountPrice"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeButton}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.editConsumptionDetail}},[t._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"打印消费单",visible:t.printConsumptionDialogVisible,fullscreen:"",center:"","before-close":t.closeButton},on:{"update:visible":function(o){t.printConsumptionDialogVisible=o}}},[o("el-form",{ref:"printConsumptionFormRef",attrs:{data:t.printConsumptionForm,"label-width":"80px",disabled:""}},[o("el-table",{staticStyle:{"margin-left":"60px","margin-right":"60px","margin-bottom":"24px",width:"auto"},attrs:{data:t.dialogTableData,border:""}},[o("el-table-column",{attrs:{prop:"goodsName",label:"商品名"}}),o("el-table-column",{attrs:{prop:"count",label:"数量"}}),o("el-table-column",{attrs:{prop:"unitPrice",label:"单价"}}),o("el-table-column",{attrs:{prop:"consumePrice",label:"消费金额"}}),o("el-table-column",{attrs:{prop:"discountRate",label:"折扣率"}}),o("el-table-column",{attrs:{prop:"discountPrice",label:"折后金额"}})],1),o("el-form-item",{attrs:{label:"入住单号",prop:"checkInId"}},[o("el-input",{model:{value:t.editConsumptionForm.checkInId,callback:function(o){t.$set(t.editConsumptionForm,"checkInId",o)},expression:"editConsumptionForm.checkInId"}})],1),o("el-form-item",{attrs:{label:"客房编号",prop:"roomId"}},[o("el-input",{model:{value:t.editConsumptionForm.roomId,callback:function(o){t.$set(t.editConsumptionForm,"roomId",o)},expression:"editConsumptionForm.roomId"}})],1),o("el-form-item",{attrs:{label:"合计",prop:"totalPrice"}},[o("el-input",{model:{value:t.editConsumptionForm.totalPrice,callback:function(o){t.$set(t.editConsumptionForm,"totalPrice",o)},expression:"editConsumptionForm.totalPrice"}})],1),o("el-form-item",{attrs:{label:"操作员",prop:"operator"}},[o("el-input",{model:{value:t.editConsumptionForm.operator,callback:function(o){t.$set(t.editConsumptionForm,"operator",o)},expression:"editConsumptionForm.operator"}})],1),o("el-form-item",{attrs:{label:"时间",prop:"time"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.editConsumptionForm.time,callback:function(o){t.$set(t.editConsumptionForm,"time",o)},expression:"editConsumptionForm.time"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.closeButton}},[t._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:t.printpage}},[t._v("打 印")])],1)],1)],1)},a=[],n=e(6265),l=e.n(n),s=e(8763),r={mounted(){l()({method:"post",url:s.Z.serverSrc+"/login/currentUser",headers:{"Content-Type":"text/plain"},data:window.sessionStorage.getItem("token")}).then((t=>{this.currentUserName=t.data.userName,this.currentUserType=t.data.userType,"管理员"!=this.currentUserType&&"前台人员"!=this.currentUserType&&(alert(this.currentUserType+"没有此权限"),this.$router.push("/homePage"))})),this.getAllConsumptions(),this.getAllGoods()},methods:{getAllGoods(){var t=this;l().get(s.Z.serverSrc+"/goods").then((o=>{o.data.code==s.Z.GET_OK?t.goods=o.data.data:alert(o.data.msg)}))},getAllConsumptions(){var t=this;l().get(s.Z.serverSrc+"/consumptions").then((o=>{o.data.code==s.Z.GET_OK?t.tableData=o.data.data:alert(o.data.msg)}))},getConsumptionById(t){var o=this;l().get(s.Z.serverSrc+"/consumptions/"+t).then((t=>{t.data.code==s.Z.GET_OK?(o.editConsumptionForm=t.data.data,o.printConsumptionForm=t.data.data):alert(t.data.msg)}))},getAllConsumptionDetail(t){var o=this;this.searchForm.consumptionId=t,l()({method:"post",url:s.Z.serverSrc+"/consumptionDetail/search",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.searchForm)}).then((t=>{o.dialogTableData=t.data.data}))},deleteByIdsConsumption(){for(var t=s.Z.serverSrc+"/consumptions/",o=0;o<this.multipleSelection.length;o++)o==this.multipleSelection.length-1?t+=this.multipleSelection[o].id:t=t+this.multipleSelection[o].id+",";l()["delete"](t).then((t=>{t.data.code==s.Z.DELETE_ERR&&alert("删除失败")})),this.consumptionDeletionDialogVisible=!1,this.massDeletionDialogVisible=!1,this.getAllConsumptions(),window.location.reload()},deleteByIdConsumption(){var t=s.Z.serverSrc+"/consumptions/";t+=this.deleteId,l()["delete"](t).then((t=>{t.data.code==s.Z.DELETE_ERR&&alert("删除失败")})),this.getAllConsumptions(),window.location.reload()},massDeletion(){this.deleteByIds(),this.massDeletionDialogVisible=!1},showConsumptionEditDialog(t){console.log(this.tableData),this.getConsumptionById(t),this.getAllConsumptionDetail(t),this.editConsumptionDialogVisible=!0,this.calculateTotalPriceEdit()},closeButton(){this.editConsumptionForm={},this.addConsumptionForm={},this.addConsumptionDialogVisible=!1,this.editConsumptionDialogVisible=!1,this.addConsumptionDetailForm={},this.editConsumptionDetailForm={},this.dialogTableData=[],this.addConsumptionDetailDialogVisible=!1,this.editConsumptionDetailDialogVisible=!1,this.printConsumptionDialogVisible=!1},showConsumptionDeleteDialog(t){this.consumptionDeletionDialogVisible=!0,this.deleteId=t},handleSizeChange(t){console.log(`每页 ${t} 条`)},handleCurrentChange(t){console.log(`当前页: ${t}`)},holdAllChange(t){this.holdGoodsChange(t).then(this.holdCountChange(t).then(this.holdDiscountRateChange(t)))},async holdGoodsChange(t){this.searchForm={},this.searchForm.name=t.goodsName;var o=this;l()({method:"post",url:s.Z.serverSrc+"/goods/search",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.searchForm)}).then((o=>{this.$set(t,"unitPrice",o.data.data[0].price);var e=t.count*t.unitPrice;this.$set(t,"consumePrice",e);var i=t.consumePrice*t.discountRate;this.$set(t,"discountPrice",i)}))},async holdCountChange(t){var o=t.count*t.unitPrice;this.$set(t,"consumePrice",o)},async holdDiscountRateChange(t){var o=t.consumePrice*t.discountRate;this.$set(t,"discountPrice",o)},addNewGoodsDetail(){this.dialogTableData.push(this.addConsumptionDetailForm),this.addConsumptionDetailDialogVisible=!1,this.calculateTotalPrice(),this.addConsumptionDetailForm={}},addEditDeletion(t){this.dialogTableData=this.dialogTableData.filter((o=>o.id!=t.id)),this.calculateTotalPrice()},calculateTotalPrice(){for(var t=0,o=0;o<this.dialogTableData.length;o++)t+=this.dialogTableData[o].discountPrice;console.log(t),this.$set(this.addConsumptionForm,"totalPrice",t),this.$set(this.editConsumptionForm,"totalPrice",t)},editConsumptionDetail(){this.dialogTableData.push(this.editConsumptionForm),this.editConsumptionDetailDialogVisible=!1,this.calculateTotalPriceEdit(),this.editConsumptionDetailFForm={}},editDeletion(t){this.dialogTableData=this.dialogTableData.filter((o=>o.id!=t.id)),this.calculateTotalPriceEdit()},calculateTotalPriceEdit(){for(var t=0,o=0;o<this.dialogTableData.length;o++)t+=this.dialogTableData[o].discountPrice;console.log(t),this.$set(this.editConsumptionForm,"totalPrice",t),this.$set(this.addConsumptionForm,"totalPrice",t)},addConsumption(){this.$refs.addConsumptionFormRef.validate((async t=>{if(!t)return console.log("error submit!!"),!1;var o=this;await l()({method:"post",url:s.Z.serverSrc+"/consumptions",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.addConsumptionForm)}),this.searchForm={},this.searchForm.time=this.addConsumptionForm.time,console.log(this.searchForm);var e=await l()({method:"post",url:s.Z.serverSrc+"/consumptions/search",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.searchForm)});this.consumptionId=e.data.data[0].id;for(var i=0;i<this.dialogTableData.length;i++)this.dialogTableData[i].consumptionId=this.consumptionId,l()({method:"post",url:s.Z.serverSrc+"/consumptionDetail",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.dialogTableData[i])}).then((t=>{t.data.code==s.Z.SAVE_ERR&&alert("添加失败")}));this.editConsumptionForm={},this.addConsumptionForm={},this.dialogTableData=[],o.getAllConsumptions(),this.addConsumptionDialogVisible=!1}))},editConsumption(){var t=s.Z.serverSrc+"/consumptionDetail/consumptionIds/";t+=this.editConsumptionForm.id,l()["delete"](t).then((t=>{t.data.code==s.Z.DELETE_ERR&&alert("删除失败")})),this.$refs.editConsumptionFormRef.validate((async t=>{if(!t)return console.log("error submit!!"),!1;var o=this;await l()({method:"put",url:s.Z.serverSrc+"/consumptions",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.editConsumptionForm)}),this.searchForm={},this.searchForm.time=this.editConsumptionForm.time,console.log(this.searchForm);var e=await l()({method:"post",url:s.Z.serverSrc+"/consumptions/search",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.searchForm)});this.consumptionId=e.data.data[0].id;for(var i=0;i<this.dialogTableData.length;i++)this.dialogTableData[i].consumptionId=this.consumptionId,l()({method:"post",url:s.Z.serverSrc+"/consumptionDetail",headers:{"Content-Type":"application/json"},data:JSON.stringify(o.dialogTableData[i])}).then((t=>{t.data.code==s.Z.SAVE_ERR&&alert("添加失败")}));this.editConsumptionForm={},this.addConsumptionForm={},this.dialogTableData=[],o.getAllConsumptions(),this.editConsumptionDialogVisible=!1}))},showPrintDialog(t){this.getAllConsumptionDetail(t),this.getConsumptionById(t),this.printConsumptionDialogVisible=!0},printpage(){window.print()},handleSelectionChange(t){this.multipleSelection=t}},data(){return{massDeletionDialogVisible:!1,consumptionDeletionDialogVisible:!1,editConsumptionDialogVisible:!1,editConsumptionForm:{id:"",roomNumber:"",totalPrice:"",operator:"",time:""},addConsumptionDetailDialogVisible:!1,addConsumptionDetailForm:{goodsName:"",count:"",unitPrice:"",consumePrice:"",discountRate:"",discountPrice:""},addConsumptionDialogVisible:!1,addConsumptionForm:{id:"",roomNumber:"",totalPrice:"",operator:"",time:""},editConsumptionDetailDialogVisible:!1,editConsumptionDetailForm:{goodsName:"",count:"",unitPrice:"",consumePrice:"",discountRate:"",discountPrice:""},printConsumptionDialogVisible:!1,printConsumptionForm:{id:"",roomNumber:"",totalPrice:"",operator:"",time:""},ConsumptionRules:{},tableData:[],dialogTableData:[],searchForm:{},input:"",currentPage4:0,goods:[],consumptionId:0,deleteId:0,multipleSelection:[]}}},d=r,m=e(3736),u=(0,m.Z)(d,i,a,!1,null,"5d597a9c",null),c=u.exports},8763:function(t,o,e){e.d(o,{Z:function(){return D}});const i="http://localhost:8080",a=20011,n=20021,l=20031,s=20041,r=20010,d=20020,m=20030,u=20040;var c,p,h={serverSrc:i,SAVE_OK:a,DELETE_OK:n,UPDATE_OK:l,GET_OK:s,SAVE_ERR:r,DELETE_ERR:d,UPDATE_ERR:m,GET_ERR:u},b=h,C=e(3736),g=(0,C.Z)(b,c,p,!1,null,null,null),D=g.exports}}]);
//# sourceMappingURL=742.6911f188.js.map