"use strict";(self["webpackChunkvue_hotel_management_project"]=self["webpackChunkvue_hotel_management_project"]||[]).push([[869],{8763:function(e,t,r){r.d(t,{Z:function(){return U}});const a="http://localhost:8080",l=20011,s=20021,i=20031,o=20041,n=20010,d=20020,c=20030,u=20040;var m,p,h={serverSrc:a,SAVE_OK:l,DELETE_OK:s,UPDATE_OK:i,GET_OK:o,SAVE_ERR:n,DELETE_ERR:d,UPDATE_ERR:c,GET_ERR:u},b=h,g=r(3736),f=(0,g.Z)(b,m,p,!1,null,null,null),U=f.exports},869:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{staticStyle:{"font-size":"24px","margin-bottom":"12px"},attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("系统管理")]),t("el-breadcrumb-item",[e._v("用户管理")])],1),t("el-row",{staticStyle:{"margin-bottom":"12px"},attrs:{gutter:20}},[t("el-col",{attrs:{span:10}},[t("el-input",{staticStyle:{"line-height":"36px"},attrs:{placeholder:"请输入用户编号"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),t("el-col",{attrs:{span:9}},[t("el-input",{staticStyle:{"line-height":"36px"},attrs:{placeholder:"请输入用户名"},model:{value:e.searchForm.userName,callback:function(t){e.$set(e.searchForm,"userName",t)},expression:"searchForm.userName"}})],1),t("el-col",{attrs:{span:1}},[t("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.conditionQuery}})],1),t("el-col",{attrs:{span:2}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUserDialogVisible=!0}}},[e._v(" 添加用户 ")])],1),t("el-col",{attrs:{span:2}},[t("el-button",{attrs:{type:"danger"},on:{click:function(t){e.massDeletionDialogVisible=!0}}},[e._v(" 批量删除 ")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"id",label:"编号",width:"180"}}),t("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),t("el-table-column",{attrs:{fixed:"right",prop:"type",label:"权限",width:"180"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showEditDialog(r.row.id)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.showDeleteDialog(r.row.id)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{title:"添加用户",visible:e.addUserDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.addUserDialogVisible=t}}},[t("el-form",{ref:"addUserFormRef",attrs:{model:e.addUserForm,rules:e.newUserRules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"编号",prop:"id"}},[t("el-input",{model:{value:e.addUserForm.id,callback:function(t){e.$set(e.addUserForm,"id",t)},expression:"addUserForm.id"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[t("el-input",{model:{value:e.addUserForm.userName,callback:function(t){e.$set(e.addUserForm,"userName",t)},expression:"addUserForm.userName"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),t("el-form-item",{attrs:{label:"权限",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择权限"},model:{value:e.addUserForm.type,callback:function(t){e.$set(e.addUserForm,"type",t)},expression:"addUserForm.type"}},[t("el-option",{attrs:{label:"管理员",value:"管理员"}}),t("el-option",{attrs:{label:"经理",value:"经理"}}),t("el-option",{attrs:{label:"前台人员",value:"前台人员"}})],1)],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.addUserForm.remark,callback:function(t){e.$set(e.addUserForm,"remark",t)},expression:"addUserForm.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addUserDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"修改用户",visible:e.editUserDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.editUserDialogVisible=t}}},[t("el-form",{ref:"editUserFormRef",attrs:{model:e.editUserForm,rules:e.editUserRules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"编号",prop:"id"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editUserForm.id,callback:function(t){e.$set(e.editUserForm,"id",t)},expression:"editUserForm.id"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[t("el-input",{model:{value:e.editUserForm.userName,callback:function(t){e.$set(e.editUserForm,"userName",t)},expression:"editUserForm.userName"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.editUserForm.password,callback:function(t){e.$set(e.editUserForm,"password",t)},expression:"editUserForm.password"}})],1),t("el-form-item",{attrs:{label:"权限",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择权限"},model:{value:e.editUserForm.type,callback:function(t){e.$set(e.editUserForm,"type",t)},expression:"editUserForm.type"}},[t("el-option",{attrs:{label:"管理员",value:"管理员"}}),t("el-option",{attrs:{label:"经理",value:"经理"}}),t("el-option",{attrs:{label:"前台人员",value:"前台人员"}})],1)],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.editUserForm.remark,callback:function(t){e.$set(e.editUserForm,"remark",t)},expression:"editUserForm.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editUserDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"删除",visible:e.deletionDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.deletionDialogVisible=t}}},[t("span",[e._v("确定要删除该项目吗？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDeleteDialog}},[e._v("取 消")]),t("el-button",{attrs:{type:"danger"},on:{click:e.deleteById}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{title:"批量删除",visible:e.massDeletionDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.massDeletionDialogVisible=t}}},[t("span",[e._v("确定要批量删除选中的项目吗？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.massDeletionDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"danger"},on:{click:e.massDeletion}},[e._v("确 定")])],1)])],1)},l=[],s=(r(1703),r(6265)),i=r.n(s),o=r(8763),n={mounted(){i()({method:"post",url:o.Z.serverSrc+"/login/currentUser",headers:{"Content-Type":"text/plain"},data:window.sessionStorage.getItem("token")}).then((e=>{this.currentUserName=e.data.userName,this.currentUserType=e.data.userType,"管理员"!=this.currentUserType&&(alert(this.currentUserType+"没有此权限"),this.$router.push("/homePage"))})),this.getAllUsers()},methods:{conditionQuery(){var e=!0;for(let r in this.searchForm)""!=this.searchForm[r]&&(e=!1);if(e)this.getAllUsers();else{var t=this;i()({method:"post",url:o.Z.serverSrc+"/users/search",headers:{"Content-Type":"application/json"},data:JSON.stringify(t.searchForm)}).then((e=>{t.tableData=e.data.data}))}},handleSizeChange(e){console.log(`每页 ${e} 条`)},handleCurrentChange(e){console.log(`当前页: ${e}`)},handleSelectionChange(e){this.multipleSelection=e},getAllUsers(){var e=this;i().get(o.Z.serverSrc+"/users").then((t=>{t.data.code==o.Z.GET_OK?e.tableData=t.data.data:alert(t.data.msg)}))},addUser(){this.$refs.addUserFormRef.validate((e=>{if(!e)return!1;var t=this;i()({method:"post",url:o.Z.serverSrc+"/users",headers:{"Content-Type":"application/json"},data:JSON.stringify(t.addUserForm)}).then((e=>{e.data.code==o.Z.SAVE_ERR&&alert("添加失败")})),t.getAllUsers(),window.location.reload(),this.addUserDialogVisible=!1}))},showEditDialog(e){var t=this;i().get(o.Z.serverSrc+"/users/"+e).then((e=>{t.editUserForm=e.data.data,this.currentEditingUserName=e.data.data.userName})),this.editUserDialogVisible=!0},showDeleteDialog(e){this.deletionDialogVisible=!0,this.deleteId=e},cancelDeleteDialog(){this.deleteId=0,this.deletionDialogVisible=!1},deleteByIds(){for(var e=o.Z.serverSrc+"/users/",t=0;t<this.multipleSelection.length;t++)t==this.multipleSelection.length-1?e+=this.multipleSelection[t].id:e=e+this.multipleSelection[t].id+",";console.log(e),i()["delete"](e).then((e=>{e.data.code==o.Z.DELETE_ERR&&alert("删除失败")})),this.deletionDialogVisible=!1,this.getAllUsers(),window.location.reload()},deleteById(){var e=o.Z.serverSrc+"/users/";e+=this.deleteId,i()["delete"](e).then((e=>{e.data.code==o.Z.DELETE_ERR&&alert("删除失败")})),this.getAllUsers(),window.location.reload()},massDeletion(){this.deleteByIds(),this.massDeletionDialogVisible=!1},editUser(){this.$refs.editUserFormRef.validate((e=>{if(!e)return console.log("error submit!!"),!1;var t=this;i()({method:"put",url:o.Z.serverSrc+"/users",headers:{"Content-Type":"application/json"},data:JSON.stringify(t.editUserForm)}).then((e=>{e.data.code==o.Z.SAVE_ERR&&alert("添加失败")})),this.editUserDialogVisible=!1,this.getAllUsers(),window.location.reload()}))}},data(){var e=(e,t,r)=>{for(var a in this.tableData)t==this.tableData[a].id&&r(new Error("编号重复"));r()},t=(e,t,r)=>{for(var a in this.tableData)t==this.tableData[a].userName&&r(new Error("用户名重复"));r()},r=(e,t,r)=>{for(var a in this.tableData)t==this.tableData[a].userName&&t!=this.currentEditingUserName&&r(new Error("用户名重复"));r()};return{massDeletionDialogVisible:!1,deletionDialogVisible:!1,addUserDialogVisible:!1,currentEditingUserName:"",addUserForm:{id:"",userName:"",password:"",type:"",remark:""},editUserDialogVisible:!1,editUserForm:{},newUserRules:{id:[{required:!0,message:"请输入编号",trigger:"blur"},{validator:e,trigger:"blur"}],userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:t,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],type:[{required:!0,message:"请选择权限",trigger:"change"}]},editUserRules:{id:[{required:!0,message:"请输入编号",trigger:"blur"}],userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:r,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],type:[{required:!0,message:"请选择权限",trigger:"change"}]},tableData:[],input:"",currentPage4:0,deleteId:0,multipleSelection:[],searchForm:{}}}},d=n,c=r(3736),u=(0,c.Z)(d,a,l,!1,null,null,null),m=u.exports}}]);
//# sourceMappingURL=869.a2c2cedc.js.map